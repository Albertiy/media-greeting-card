<html lang="zh"><head><title>数据库设计文档</title><style type='text/css'>body {            padding-bottom: 50px        }        body, td {            font-family: verdana, fantasy;            font-size: 12px;            line-height: 150%        }        table {            width: 100%;            background-color: #ccc;            margin: 5px 0        }        td {            background-color: #fff;            padding: 3px 3px 3px 10px        }        thead td {            text-align: center;            font-weight: bold;            background-color: #eee        }        a:link, a:visited, a:active {            color: #015fb6;            text-decoration: none        }        a:hover {            color: #e33e06        }</style></head><body style='text-align:center;'><div style='width:800px; margin:20px auto; text-align:left;'><a name='index'></a><h2 style='text-align:center; line-height:50px;'>数据库设计文档</h2><div><b>数据库名：heka</b><br><b>文档版本：1.0.5</b><br><b>文档描述：生成文档信息描述</b><br></div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>表名</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td><a href='#article'>article</a></td><td></td></tr><tr><td style='text-align:center;'>2</td><td><a href='#article_template'>article_template</a></td><td>文章模板。用来复制默认的骨架对象。骨架对象中自带了默认的背景、音乐等内容。以及供用户自定义的属性。</td></tr><tr><td style='text-align:center;'>3</td><td><a href='#bgimage'>bgimage</a></td><td></td></tr><tr><td style='text-align:center;'>4</td><td><a href='#generaterecords'>generaterecords</a></td><td></td></tr><tr><td style='text-align:center;'>5</td><td><a href='#imagefiles'>imagefiles</a></td><td>统一文件模块。待定，因为目前没有这个需求。目前的所有文件都是与产品和code强关联的。之所以不用还加这个表，是因为文章有默认图片，存储在数据库，故保存图片的id而不是路径。也许需要“资源类型”选项。</td></tr><tr><td style='text-align:center;'>6</td><td><a href='#music'>music</a></td><td></td></tr><tr><td style='text-align:center;'>7</td><td><a href='#product'>product</a></td><td>商品类目表

字典表，是对于程序逻辑大部分情况下只读的表。

product：目前只有音视频贺卡和图文钥匙扣两种。

music：用于程序的BGM展示，当用户不自己上传时（如果有）从中选择。
严格来说，是内置资源，不需要存储在数据库中，只需放在前端项目中即可。
但是数据是从中读取的，本身就有延迟，因此用了也无所谓。</td></tr><tr><td style='text-align:center;'>8</td><td><a href='#uploadfiles'>uploadfiles</a></td><td>产品</td></tr></table><a name='article'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：article</b></div><div>说明：</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>code_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>uploadfiles表其实就是code表，因此关联到其id。</td></tr><tr><td style='text-align:center;'>3</td><td>template_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>模板序号</td></tr><tr><td style='text-align:center;'>4</td><td>skeleton</td><td align='center'>text</td><td align='center'>65535</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>5</td><td>paragraph_set</td><td align='center'>json</td><td align='center'>1073741824</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>json_array()</td><td align='center'>文本段落模块（私有），结构：id，content，font，color，或者干脆把文本保存为html语句得了？</td></tr><tr><td style='text-align:center;'>6</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='article_template'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：article_template</b></div><div>说明：文章模板。用来复制默认的骨架对象。骨架对象中自带了默认的背景、音乐等内容。以及供用户自定义的属性。</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>name</td><td align='center'>varchar</td><td align='center'>20</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>skeleton</td><td align='center'>json</td><td align='center'>1073741824</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>json_object()</td><td align='center'>大纲；框架；结构：[{type, id}]；我看order就不用了。
type枚举：image，paragraph，video，audio，background_audio（也是音乐，可能从默认模板中获取），background_image，template（模板）。
感情我是设计了一个类型啊。</td></tr><tr><td style='text-align:center;'>4</td><td>selectable</td><td align='center'>tinyint</td><td align='center'>4</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>1</td><td align='center'></td></tr><tr><td style='text-align:center;'>5</td><td>order</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='bgimage'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：bgimage</b></div><div>说明：</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>product_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>name</td><td align='center'>varchar</td><td align='center'>128</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>4</td><td>path</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>5</td><td>order</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='generaterecords'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：generaterecords</b></div><div>说明：</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>count</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'>1</td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>product_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>4</td><td>first</td><td align='center'>varchar</td><td align='center'>45</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>5</td><td>latest</td><td align='center'>varchar</td><td align='center'>45</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>filePath</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>8</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='imagefiles'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：imagefiles</b></div><div>说明：统一文件模块。待定，因为目前没有这个需求。目前的所有文件都是与产品和code强关联的。之所以不用还加这个表，是因为文章有默认图片，存储在数据库，故保存图片的id而不是路径。也许需要“资源类型”选项。</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>code_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>path</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>相对于根目录的路径，如 image/xxxx-xxxxx-xxxxx.png</td></tr><tr><td style='text-align:center;'>4</td><td>temp_path</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>相对于根目录的路径，如 image/xxxx-xxxxx-xxxxx.png</td></tr><tr><td style='text-align:center;'>5</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='music'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：music</b></div><div>说明：</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>product_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>name</td><td align='center'>varchar</td><td align='center'>128</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>4</td><td>author</td><td align='center'>varchar</td><td align='center'>45</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>5</td><td>path</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>order</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>8</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='product'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：product</b></div><div>说明：商品类目表

字典表，是对于程序逻辑大部分情况下只读的表。

product：目前只有音视频贺卡和图文钥匙扣两种。

music：用于程序的BGM展示，当用户不自己上传时（如果有）从中选择。
严格来说，是内置资源，不需要存储在数据库中，只需放在前端项目中即可。
但是数据是从中读取的，本身就有延迟，因此用了也无所谓。</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>name</td><td align='center'>varchar</td><td align='center'>32</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>4</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table><a name='uploadfiles'></a><div style='margin-top:30px;'><a href='#index'                                         style='float:right; margin-top:6px;'>返回目录</a><b>表名：uploadfiles</b></div><div>说明：产品</div><div>数据列：</div><table cellspacing='1'><thead><tr><td style='width:40px; '>序号</td><td>名称</td><td>数据类型</td><td>长度</td><td>小数位</td><td>允许空值</td><td>主键</td><td>默认值</td><td>说明</td></tr></thead><tr><td style='text-align:center;'>1</td><td>id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>N</td><td align='center'>Y</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>2</td><td>uuid</td><td align='center'>varchar</td><td align='center'>45</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>3</td><td>record_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>4</td><td>product_id</td><td align='center'>int</td><td align='center'>10</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>虽然在生成时按照批次的产品类型，但为了可修改性，为每一个code提供产品类型字段，方便单独修改。</td></tr><tr><td style='text-align:center;'>5</td><td>text_from</td><td align='center'>varchar</td><td align='center'>22</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>6</td><td>text_to</td><td align='center'>varchar</td><td align='center'>22</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>7</td><td>text_detail</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>8</td><td>videoPath</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>9</td><td>audioPath</td><td align='center'>varchar</td><td align='center'>255</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr><tr><td style='text-align:center;'>10</td><td>isLocked</td><td align='center'>tinyint</td><td align='center'>4</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'>0</td><td align='center'></td></tr><tr><td style='text-align:center;'>11</td><td>isDeleted</td><td align='center'>tinyint</td><td align='center'>4</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'>0</td><td align='center'></td></tr><tr><td style='text-align:center;'>12</td><td>modify_pwd</td><td align='center'>varchar</td><td align='center'>20</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>编辑管理密码</td></tr><tr><td style='text-align:center;'>13</td><td>access_pwd</td><td align='center'>varchar</td><td align='center'>20</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'>访问查看密码</td></tr><tr><td style='text-align:center;'>14</td><td>create_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>N</td><td align='center'>N</td><td align='center'>CURRENT_TIMESTAMP</td><td align='center'></td></tr><tr><td style='text-align:center;'>15</td><td>modify_time</td><td align='center'>timestamp</td><td align='center'>19</td><td align='center'>0</td><td align='center'>Y</td><td align='center'>N</td><td align='center'></td><td align='center'></td></tr></table></div><footer></footer></body></html>